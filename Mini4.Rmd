---
title: "Mini Project 4"
author: "Jemimah Charles"
date: "April 18, 2018"
output: html_document
---

```{r}
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")

sql <- "
SELECT t.id, t.title, t.production_year, MAX(mii.info) AS rating, mii2.info AS votes, mi.info AS genre
FROM title t
JOIN movie_info_idx mii ON mii.movie_id = t.id
JOIN movie_info_idx mii2 ON mii2.movie_id = t.id
JOIN movie_info mi ON mi.movie_id=t.id
WHERE t.kind_id = 1
  AND mi.info_type_id = 3
  AND mii.info_type_id = 101
  AND mii2.info_type_id = 100
  AND mii2.info > 10000
  AND t.production_year >1919
GROUP BY t.production_year;
"
best_movies <- db %>%
  dbGetQuery(sql)

head(best_movies)

ggplot(best_movies, aes(x = production_year, y = rating, color = factor(genre))) +
  geom_point()

```
